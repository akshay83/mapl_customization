[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Installation Note", 
  "modified": "2016-07-07 20:20:55.126289", 
  "name": "Installation Note-Client", 
  "script": "frappe.ui.form.on(\"Installation Note\", \"onload\", function(frm) {\n   frm.set_query(\"customer\", function(doc) {\n   \treturn{\n\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_customer_query\"\n\t}\n   });\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Purchase Receipt", 
  "modified": "2016-07-28 18:53:52.343217", 
  "name": "Purchase Receipt-Client", 
  "script": "cur_frm.add_fetch('item_code', 'is_vehicle', 'is_vehicle');\n/***************************************************************/\n/*              Invoke Dialog On Child Form                    */\n/***************************************************************/\n\nfrappe.ui.form.on(\"Purchase Receipt\", \"items_on_form_rendered\", function(frm) {\n    // Important Note : Sub Form Fieldname+\"_on_form_rendered\" would trigger and add\n    // The button in child form\n    var grid_row = cur_frm.open_grid_row();\n\n    // Add Button to Child Form ... Wrap it around the \"dialog_result\" field\n    var $btn = $('<button class=\"btn btn-sm btn-default\">' + __(\"Add Serial No\") + '</button>')\n        .appendTo($(\"<div>\")\n            .css({\n                \"margin-bottom\": \"10px\",\n                \"margin-top\": \"10px\"\n            })\n            .appendTo(grid_row.grid_form.fields_dict.serial_no.$wrapper));\n\n    // Bind a Event to Added Button\n    $btn.on(\"click\", function() {\n        var fields = [];\n        for (var rows = 1; rows <= grid_row.grid_form.fields_dict.received_qty.get_value() + 1; rows++) {\n            fields.push({\n                label: \"Row No:\".concat(rows),\n                fieldname: \"row_no_\".concat(rows),\n                fieldtype: \"Section Break\"\n            });\n            for (var columns = 1; columns <= 3; columns++) {\n                if (columns == 1) {\n                    fields.push({\n                        label: \"Serial/Chassis No\",\n                        fieldname: \"chassis_no_\".concat(rows),\n                        fieldtype: \"Data\",\n                        reqd: 1\n                    });\n                }\n                if (grid_row.grid_form.fields_dict['is_vehicle'].value == 1) {\n                    if (columns == 2) {\n                        fields.push({\n                            label: \"Engine No\",\n                            fieldname: \"engine_no_\".concat(rows),\n                            fieldtype: \"Data\",\n                            reqd: 1\n                        });\n                    }\n                    if (columns == 3) {\n                        fields.push({\n                            label: \"Key No\",\n                            fieldname: \"key_no_\".concat(rows),\n                            fieldtype: \"Data\",\n                            reqd: 1\n                        });\n                    }\n                    if (columns < 3) {\n                        fields.push({\n                            fieldname: \"column_no_\".concat(columns),\n                            fieldtype: \"Column Break\"\n                        });\n                    }\n                }\n            }\n        }\n        // Add \"Add\" Button to the Dialog\n        fields.push({\n            fieldtype: \"Section Break\"\n        });\n        //fields.push({fieldtype: \"Button\", \"label\": \"Set\", fieldname: \"add\"});\n\n\n        var d = new frappe.ui.Dialog({\n            title: __(\"Add Serial No\"),\n            fields\n        });\n\n        if (grid_row.grid_form.fields_dict.serial_no.get_value() != \"\") {\n            var existing_serial_no = grid_row.grid_form.fields_dict.serial_no.get_value().split(\"\\n\");\n            var existing_engine_no = grid_row.grid_form.fields_dict.serial_no.get_value().split(\"\\n\");\n            var existing_key_no = grid_row.grid_form.fields_dict.serial_no.get_value().split(\"\\n\");\n            for (var row = 1; row <= existing_serial_no.length + 1; row++) {\n                d.set_value(\"chassis_no_\".concat(row), existing_serial_no[row - 1]);\n                d.set_value(\"engine_no_\".concat(row), existing_engine_no[row - 1]);\n                d.set_value(\"key_no_\".concat(row), existing_key_no[row - 1]);\n            }\n        }\n        //Bind Event to Add Button in Dialog\n        d.set_primary_action(__(\"Save\"), function() {\n            /*****************/\n            args = d.get_values();\n            if (!args) return;\n            frappe.call({\n                method: \"mapl_customization.customizations_for_mapl.utils.validate_input_serial\",\n                args: {\n                    \"args\": d.get_values(),\n                    \"rows\": grid_row.grid_form.fields_dict.received_qty.get_value() + 1,\n                    \"is_vehicle\": grid_row.grid_form.fields_dict['is_vehicle'].value\n                },\n\n                callback: function(r) {\n                    if (!r.message) {\n                        //return;\n                    }\n                }\n            });\n\n            /*****************/\n\n            //d.get_input(\"add\").on(\"click\", function() {\n            var result_serial_no = \"\";\n            var result_engine_no = \"\";\n            var result_key_no = \"\";\n            for (var rows = 1; rows <= grid_row.grid_form.fields_dict.received_qty.get_value() + 1; rows++) {\n                result_serial_no = result_serial_no.concat(d.get_value(\"chassis_no_\".concat(rows)), \"\\n\");\n                //Set Resultant Value from Dialog in a Child Form Field - Here dialog_result\n                grid_row.grid_form.fields_dict.serial_no.set_model_value(result_serial_no);\n                result_engine_no = result_engine_no.concat(d.get_value(\"engine_no_\".concat(rows)), \"\\n\");\n                //Set Resultant Value from Dialog in a Child Form Field - Here dialog_result\n                grid_row.grid_form.fields_dict.engine_nos.set_model_value(result_engine_no);\n                result_key_no = result_key_no.concat(d.get_value(\"key_no_\".concat(rows)), \"\\n\");\n                //Set Resultant Value from Dialog in a Child Form Field - Here dialog_result\n                grid_row.grid_form.fields_dict.key_nos.set_model_value(result_key_no);\n            }\n            d.hide();\n            return false;\n        });\n\n        d.show();\n    });\n});\n/***************************************************************/\n/*              End Dialog On Child Form                       */\n/***************************************************************/", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Customer", 
  "modified": "2017-03-01 14:21:42.998377", 
  "name": "Customer-Client", 
  "script": "frappe.ui.form.on(\"Customer\",\"refresh\", function(frm) {\n\t\tif (frm.doc.__islocal) {\n\t\t\tfrm.add_custom_button(__('Quick Entry'), function() {\n\t\t\t\treturn cur_frm.quick_entry(frm);\n\t\t\t});\n\t\t}\n\n                   custom._get_party_balance_in_drcr('Customer', frm.doc.name,\n\t\t\t\t\t\t\tfrappe.defaults.get_user_default(\"company\"), function(result) { \n\t\t\t\t\t\t\t\tfrm.doc.current_balance=result; \nrefresh_field(\"current_balance\");\n                             });\n});\n\ncur_frm.quick_entry = function (doc) {\n\t\tvar dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Quick Customer Entry\"),\n\t\t\tfields: [\n\t\t\t\t{fieldtype: \"Select\", fieldname: \"customer_type\", label: __(\"Customer Type\"), reqd: 1, options: \"Company\\nIndividual\"},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"customer_name\", label: __(\"Customer Name\"), reqd: 1},\n                {fieldtype: \"Data\", fieldname: \"company_name\", label: __(\"Company Name\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"tax_id\", label: __(\"Tax ID\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"primary_contact_no\", label: __(\"Primary Contact No\"), reqd: 1},\n\t\t\t\t{fieldtype: \"Column Break\", fieldname: \"column_break_2\"},\n\t\t\t\t{fieldtype: \"Link\", fieldname: \"customer_group\", label: __(\"Customer Group\"), reqd: 1, options: \"Customer Group\"},\n\t\t\t\t{fieldtype: \"Link\", fieldname: \"territory\", label: __(\"Territory\"), reqd: 1, options: \"Territory\"},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"pan_no\", label: __(\"PAN No\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"secondary_contact_no\", label: __(\"Secondary Contact No\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Section Break\", fieldname: \"section_break_1\"},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"billing_address_1\", label: __(\"Billing Address 1\"), reqd: 1},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"billing_address_2\", label: __(\"Billing Address 2\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"billing_city\", label: __(\"Billing City\"), reqd: 1},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"billing_state\", label: __(\"Billing State\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Link\", fieldname: \"billing_country\", label: __(\"Billing Country\"), reqd: 0, options:\"Country\"},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"billing_phone\", label: __(\"Billing Phone\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"billing_fax\", label: __(\"Billing Fax\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"billing_email_id\", label: __(\"Billing Email ID\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Column Break\", fieldname: \"column_break_1\"},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"shipping_address_1\", label: __(\"Shipping Address 1\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"shipping_address_2\", label: __(\"Shipping Address 2\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"shipping_city\", label: __(\"Shipping City\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"shipping_state\", label: __(\"Shipping State\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Link\", fieldname: \"shipping_country\", label: __(\"Shipping Country\"), reqd: 0, options:\"Country\"},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"shipping_phone\", label: __(\"Shipping Phone\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"shipping_fax\", label: __(\"Shipping Fax\"), reqd: 0},\n\t\t\t\t{fieldtype: \"Data\", fieldname: \"shipping_email_id\", label: __(\"Shipping Email ID\"), reqd: 0},\n                {fieldtype: \"Check\", fieldname: \"shipping_preferred\", label: __(\"Is Preferred Shipping Address\") }\n\t\t\t]\n\t\t});    \n\n\n\t//TO HIDE A FIELD IN DIALOG\n\tvar fd = dialog.fields_dict;\n\n\t$(fd.company_name.wrapper).toggle(fd.customer_type.get_value()==='Individual')\n\t$(fd.customer_type.input).change(function() {\n\t\t$(fd.company_name.wrapper).toggle(fd.customer_type.get_value()==='Individual');\n\t});\n\n\n\tdialog.set_primary_action(__(\"Save\"), function() {\n\t\targs = dialog.get_values();\n\t\tif (!args) return;\n\t\tfrappe.call({\n\t\t\tmethod:\"mapl_customization.customizations_for_mapl.quick_customer.do_quick_entry\",\n\t\t\targs : { \"args\": dialog.get_values() },\n\t\t\tcallback: function (r) {\n\t\t\t\tif (r.message) {\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\tvar doc = r.message;\n\t\t\t\t\tif (frappe._from_link) {\n  \t\t\t\t\t\tfrappe.ui.form.update_calling_link(doc);\n\t\t\t\t\t} else {\n\t\t\t\t\t  \tfrappe.set_route(\"Form\", doc.doctype, doc.name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\n\tdialog.show();\n        //$(\"div\").find(\".modal-dialog\").css({\"line-height\":\".5\"});\n        //$(\"div[class*='modal-dialog']\").find(\".control-label\").css({\"font-size\":\"12px\",\"font-weight\":\"500\",\"margin-bottom\":\"1px\"});\n        //$(\"div\").find(\".modal-dialog\").attr(\"style\",\"font-size: 8px !important\");\n        //$(\"div[class*='modal-dialog']\").find(\".control-input\").css({\"line-height\":\"1\",\"font-size\":\"10px\"});\n}\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Invoice", 
  "modified": "2017-03-03 13:21:38.434443", 
  "name": "Sales Invoice-Client", 
  "script": "//ADD MENU ITEM IN MENU DROPDOWN BUTTON\nfrappe.ui.form.on(\"Sales Invoice\", \"refresh\", function(frm) {\n   if (frm.doc.docstatus == 0) { \n   frm.page.add_menu_item(__('Cancel'), function() { frm.savecancel() });\n   }\n});\n\n//TO HIDE PRINT ICON & PRINT MENU FROM A DOCUMENT IN VERSION 6 USE\nfrappe.ui.form.on(\"Sales Invoice\",\"refresh\",function(frm) {\n    if (frm.doc.docstatus != 1) {\n        $('ul[class=\"dropdown-menu\"] a:contains(\"Print\")').hide(); //HIDE MENU ENTRY - FIND BASED ON TEXT AND <A> //\n        $(\".icon-print\").hide(); //HIDE PRINT ICON - FIND BASED ON ID //\n    } else {\n        $('a:contains(\"Print\")').show(); //HIDE MENU ENTRY - FIND BASED ON TEXT AND <A> //\n        $(\".icon-print\").show(); //HIDE PRINT ICON - FIND BASED ON ID //    \n    }\n    //TO FILL VOLATILE TYPE FIELD \n    //if (frm.doc.customer!=null) {\n    //    frappe.model.get_value(\"Customer\",frm.doc.customer,\"tax_id\", function(value) {;\n    //         frm.set_value(\"test_vat\",value.tax_id);\n    //    });\n    //}\n});\n\ncur_frm.add_fetch('item_code','is_vehicle','is_vehicle');\ncur_frm.add_fetch('customer','tax_id','test_vat');\n\ncur_frm.cscript.onload = function() {\n   cur_frm.set_query(\"customer\", function(doc) {\n   \treturn{\n\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_customer_query\"\n\t}\n   });\n   cur_frm.set_query(\"shipping_address_name\", function(doc) {\n   \treturn{\n\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_address_query\",\n                filters: {'customer':doc.customer}\n\t}\n   });\n};\nfrappe.ui.form.on(\"Sales Invoice\", \"shipping_address_name\", function(frm) {\n    if (!frm.doc.shipping_address_name) {\n       frm.set_value(\"shipping_address\",null);\n    }\n});\nfrappe.ui.form.on(\"Sales Invoice\", \"is_finance\", function (frm) {\n         cur_frm.set_df_property(\"hypothecation\", \"reqd\", frm.doc.is_finance==1);\n         cur_frm.refresh_field(\"hypothecation\");\n});\nfrappe.ui.form.on(\"Sales Invoice\", \"delayed_payment\", function (frm) {\n         cur_frm.set_df_property(\"referred_by\", \"reqd\", frm.doc.delayed_payment==1);\n         cur_frm.refresh_field(\"referred_by\");\n});\nfrappe.ui.form.on(\"Sales Invoice\", \"customer\", function (frm) {\n        cur_frm.set_df_property(\"customer_name\", \"hidden\", false);\n             if (frm.doc.customer) {\n                   custom._get_party_balance_formatted('Customer', frm.doc.customer,\n\t\t\t\t\t\t\tfrm.doc.company, function(result) { \n\t\t\t\t\t\t\t\tshow_alert(result,8); \n                             });\n             }\n});\n\nfrappe.ui.form.on(\"Sales Invoice\", \"items_on_form_rendered\", function(frm) {\n    // Important Note : Sub Form Fieldname+\"_on_form_rendered\" would trigger and add\n    // The button in child form\n    var grid_row = cur_frm.open_grid_row();\n\n    // Add Button to Child Form ... Wrap it around the \"dialog_result\" field\n    var $btn = $('<button class=\"btn btn-sm btn-default\">' + __(\"Current Stock\") + '</button>')\n        .appendTo($(\"<div>\")\n            .css({\n                \"margin-bottom\": \"10px\",\n                \"margin-top\": \"10px\"\n            })\n            .appendTo(grid_row.grid_form.fields_dict.item_code.$wrapper));\n\n    // Bind a Event to Added Button\n    $btn.on(\"click\", function() {\n\tif (grid_row.grid_form.fields_dict.item_code.value) {\n            frappe.call({\n                method: \"mapl_customization.customizations_for_mapl.utils.get_effective_stock_at_all_warehouse\",\n                args: {\n                    \"item_code\": grid_row.grid_form.fields_dict.item_code.value,\n                    \"date\": cur_frm.doc.posting_date\n                },\n\n                callback: function(r) {\n                    if (r.message) {\n                        custom.show_stock_dialog(r.message);\n                    }\n                }\n            });\t\n\t}\n    });\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Stock Problem", 
  "modified": "2016-08-27 18:09:02.567663", 
  "name": "Stock Problem-Client", 
  "script": "frappe.ui.form.on(\"Stock Problem\", \"refresh\", function (frm) {\n   cur_frm.toggle_enable(\"status\",frm.doc.status===\"Open\")\n});\nfrappe.ui.form.on(\"Stock Problem\", \"status\", function (frm) {\n         cur_frm.set_df_property(\"resolution\", \"reqd\", frm.doc.status==\"Closed\");\n});\n\nfrappe.ui.form.on(\"Stock Problem\", \"onload\", function(frm) {\n   cur_frm.set_query(\"customer\", function(doc) {\n   \treturn{\n\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_customer_query\"\n\t}\n   });\n});\nfrappe.ui.form.on(\"Stock Problem\", \"is_customer_return\", function (frm) {\n         cur_frm.set_df_property(\"customer\", \"reqd\", frm.doc.is_customer_return==1);\n         cur_frm.set_df_property(\"returned_on\", \"reqd\", frm.doc.is_customer_return==1);\n         cur_frm.refresh_field(\"hypothecation\");\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Delivery Note", 
  "modified": "2016-02-23 19:13:58.311787", 
  "name": "Delivery Note-Client", 
  "script": "cur_frm.add_fetch('item_code','is_vehicle','is_vehicle');\nfrappe.ui.form.on(\"Delivery Note\", \"shipping_address_name\", function(frm) {\n    if (!frm.doc.shipping_address_name) {\n       frm.set_value(\"shipping_address\",null);\n    }\n});\ncur_frm.cscript.onload = function() {\n   cur_frm.set_query(\"customer\", function(doc) {\n   \treturn{\n\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_customer_query\"\n\t}\n   });\n   cur_frm.set_query(\"shipping_address_name\", function(doc) {\n   \treturn{\n\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_address_query\",\n                filters: {'customer':doc.customer}\n\t}\n   });\n};", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Receipts", 
  "modified": "2017-03-03 13:22:25.073858", 
  "name": "Receipts-Client", 
  "script": "//TO HIDE PRINT ICON & PRINT MENU FROM A DOCUMENT IN VERSION 6 USE\nfrappe.ui.form.on(\"Receipts\",\"refresh\",function(frm) {\n\tif (frm.doc.docstatus != 1) {\n        $('ul[class=\"dropdown-menu\"] a:contains(\"Print\")').hide(); //HIDE MENU ENTRY - FIND BASED ON TEXT AND <A> //\n        $(\".icon-print\").hide(); //HIDE PRINT ICON - FIND BASED ON ID //\n    } else {\n        $('a:contains(\"Print\")').show(); //HIDE MENU ENTRY - FIND BASED ON TEXT AND <A> //\n        $(\".icon-print\").show(); //HIDE PRINT ICON - FIND BASED ON ID //    \n    }\n});\n\nfrappe.ui.form.on(\"Receipts\", \"onload\", function(frm) {\n\tfrm.set_query(\"payment_account\", function() {\n\t\treturn {\n\t\t\tfilters: {\n\t\t\t\t\"account_type\": [\"in\", [\"Bank\", \"Cash\"]],\n\t\t\t\t\"is_group\": 0,\n\t\t\t\t\"company\": frm.doc.company\n\t\t\t}\n\t\t}\n\t});\n   frm.set_query(\"party\", function(doc) {\n   \treturn{\n\t\tquery: \"mapl_customization.customizations_for_mapl.queries.select_customer_supplier_query\",\n        filters: {'party_type':doc.party_type }\n\t}\n   });\n   frm.set_query(\"party_address\", function(doc) {\n       if (doc.party_type==\"Customer\") {\n\t   \treturn{\n\t\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_address_query\",\n\t                filters: {'customer':doc.party}\n\t\t\t}\n       } else {\n\t   \treturn{\n\t\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_address_query\",\n\t                filters: {'supplier':doc.party}\n\t\t\t}\n       }\n   });\n});\nfrappe.ui.form.on(\"Receipts\", \"party\", function(frm) {\n\tif(frm.doc.party_type && frm.doc.party) {\n\t\tfrappe.call({\n\t\t\tmethod: \"mapl_customization.customizations_for_mapl.utils.get_party_name\",\n\t\t\targs: {\n\t\t\t\tparty_type: frm.doc.party_type,\n\t\t\t\tparty: frm.doc.party\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tif(!r.exc && r.message) {\n\t\t\t\t\tfrm.set_value(\"party_name\", r.message);\n\t\t\t\t}\n\t\t\t}\n\t\t});    \n\t\tfrappe.call({\n\t\t\tmethod: \"erpnext.accounts.party.get_party_account\",\n\t\t\targs: {\n\t\t\t\tcompany: frm.doc.company,\n\t\t\t\tparty_type: frm.doc.party_type,\n\t\t\t\tparty: frm.doc.party\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tif(!r.exc && r.message) {\n\t\t\t\t\tfrm.set_value(\"party_account\", r.message);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n          frm.call({\n            method: \"mapl_customization.customizations_for_mapl.utils.get_primary_billing_address\",\n            args: {\n\t\t\t\tparty_type: frm.doc.party_type,\n\t\t\t\tparty: frm.doc.party\n            },\n            callback: function(r) {\n                  if(r.message)\n                     frm.set_value(\"party_address\", r.message);\n                  else\n                     frm.set_value(\"party_address\", null);\n                } \n        });\n        custom._get_party_balance_formatted(frm.doc.party_type, frm.doc.party,\n\t\t\t\tfrm.doc.company, function(result) { \n\t\t\t\t\tshow_alert(result,8); \n                });                  \n\t}\n});\n\nfrappe.ui.form.on(\"Receipts\", \"party_address\", function(frm) {\n   if (frm.doc.party_address) {\n          frm.call({\n            method: \"mapl_customization.customizations_for_mapl.utils.fetch_address_details_payments_receipts\",\n            args: {\n                party_address: frm.doc.party_address\n            },\n            callback: function(r) {\n                  if(r.message)\n                     frm.set_value(\"address\", r.message);\n                }\n        });   \n   } else\n        frm.set_value(\"address\", null);   \n});\n// Fetch bank/cash account based on payment mode\nfrappe.ui.form.on(\"Receipts\", \"payment_mode\", function(frm) {\n\treturn  frappe.call({\n\t\tmethod: \"erpnext.accounts.doctype.sales_invoice.sales_invoice.get_bank_cash_account\",\n\t\targs: {\n\t\t\t\t\"mode_of_payment\": frm.doc.payment_mode,\n\t\t\t\t\"company\": frm.doc.company\n\t\t},\n\t\tcallback: function(r, rt) {\n\t\t\tif(r.message) {\n\t\t\t\tcur_frm.set_value(\"payment_account\", r.message['account']);\n\t\t\t}\n\t\t}\n\t});\n});\n\n\ncur_frm.fields_dict['party_address'].get_query = function(doc, cdt, cdn) {\n      if (doc.party_type==\"Customer\") {\n\treturn{\n    \tfilters:{'customer': doc.party}\n  \t}\n      } else {\n\treturn{\n    \tfilters:{'supplier': doc.party}\n  \t}\n      }\n};", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Payments", 
  "modified": "2016-07-10 19:53:06.732633", 
  "name": "Payments-Client", 
  "script": "frappe.ui.form.on(\"Payments\", \"onload\", function(frm) {\n\tfrm.set_query(\"payment_account\", function() {\n\t\treturn {\n\t\t\tfilters: {\n\t\t\t\t\"account_type\": [\"in\", [\"Bank\", \"Cash\"]],\n\t\t\t\t\"is_group\": 0,\n\t\t\t\t\"company\": frm.doc.company\n\t\t\t}\n\t\t}\n\t});\n   frm.set_query(\"party\", function(doc) {\n   \treturn{\n\t\tquery: \"mapl_customization.customizations_for_mapl.queries.select_customer_supplier_query\",\n        filters: {'party_type':doc.party_type }\n\t}\n   });\n   frm.set_query(\"party_address\", function(doc) {\n       if (doc.party_type==\"Customer\") {\n\t   \treturn{\n\t\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_address_query\",\n\t                filters: {'customer':doc.party}\n\t\t\t}\n       } else {\n\t   \treturn{\n\t\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_address_query\",\n\t                filters: {'supplier':doc.party}\n\t\t\t}\n       }\n   });\n\n});\n\nfrappe.ui.form.on(\"Payments\", \"party\", function(frm) {\n\tif(frm.doc.party_type && frm.doc.party) {\n\t\tfrappe.call({\n\t\t\tmethod: \"mapl_customization.customizations_for_mapl.utils.get_party_name\",\n\t\t\targs: {\n\t\t\t\tparty_type: frm.doc.party_type,\n\t\t\t\tparty: frm.doc.party\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tif(!r.exc && r.message) {\n\t\t\t\t\tfrm.set_value(\"party_name\", r.message);\n\t\t\t\t}\n\t\t\t}\n\t\t});  \n\t\tfrappe.call({\n\t\t\tmethod: \"erpnext.accounts.party.get_party_account\",\n\t\t\targs: {\n\t\t\t\tcompany: frm.doc.company,\n\t\t\t\tparty_type: frm.doc.party_type,\n\t\t\t\tparty: frm.doc.party\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tif(!r.exc && r.message) {\n\t\t\t\t\tfrm.set_value(\"party_account\", r.message);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n          frm.call({\n            method: \"mapl_customization.customizations_for_mapl.utils.get_primary_billing_address\",\n            args: {\n\t\t\t\tparty_type: frm.doc.party_type,\n\t\t\t\tparty: frm.doc.party\n            },\n            callback: function(r) {\n                  if(r.message)\n                     frm.set_value(\"party_address\", r.message);\n                  else\n                     frm.set_value(\"party_address\", null);\n                } \n        });\n        custom._get_party_balance_formatted(frm.doc.party_type, frm.doc.party,\n\t\t\t\tfrm.doc.company, function(result) { \n\t\t\t\t\tshow_alert(result,8); \n                });   \t\t\n\t}\n});\n\nfrappe.ui.form.on(\"Payments\", \"party_address\", function(frm) {\n   if (frm.doc.party_address) {\n          frm.call({\n            method: \"mapl_customization.customizations_for_mapl.utils.fetch_address_details_payments_receipts\",\n            args: {\n                party_address: frm.doc.party_address\n            },\n            callback: function(r) {\n                  if(r.message)\n                     frm.set_value(\"address\", r.message);\n                }\n        });   \n   } else\n        frm.set_value(\"address\", null);   \n});\n// Fetch bank/cash account based on payment mode\nfrappe.ui.form.on(\"Payments\", \"payment_mode\", function(frm) {\n\treturn  frappe.call({\n\t\tmethod: \"erpnext.accounts.doctype.sales_invoice.sales_invoice.get_bank_cash_account\",\n\t\targs: {\n\t\t\t\t\"mode_of_payment\": frm.doc.payment_mode,\n\t\t\t\t\"company\": frm.doc.company\n\t\t},\n\t\tcallback: function(r, rt) {\n\t\t\tif(r.message) {\n\t\t\t\tcur_frm.set_value(\"payment_account\", r.message['account']);\n\t\t\t}\n\t\t}\n\t});\n});\n\n\ncur_frm.fields_dict['party_address'].get_query = function(doc, cdt, cdn) {\n      if (doc.party_type==\"Customer\") {\n\treturn{\n    \tfilters:{'customer': doc.party}\n  \t}\n      } else {\n\treturn{\n    \tfilters:{'supplier': doc.party}\n  \t}\n      }\n};", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Order", 
  "modified": "2016-09-15 18:00:33.633265", 
  "name": "Sales Order-Client", 
  "script": "cur_frm.add_fetch('item_code','is_vehicle','is_vehicle');\nfrappe.ui.form.on(\"Sales Order\", \"is_finance\", function (frm) {\n         cur_frm.set_df_property(\"hypothecation\", \"reqd\", frm.doc.is_finance==1);\n         cur_frm.refresh_field(\"hypothecation\");\n});\nfrappe.ui.form.on(\"Sales Order\", \"customer\", function (frm) {\n        cur_frm.set_df_property(\"customer_name\", \"hidden\", false);\n             if (frm.doc.customer) {\n\t\tfrappe.call({\n\t\t\tmethod: \"mapl_customization.customizations_for_mapl.utils.get_party_balance\",\n\t\t\targs: {\n\t\t\t\tparty: frm.doc.customer,\n\t\t\t\tcompany: frm.doc.company,\n                                party_type: \"Customer\"\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tif(!r.exc && r.message) {\n                                    var alert_msg = frm.doc.customer+\" Current Balance:\";\n                                    if (parseFloat(r.message) > 0) {\n                                          alert_msg = alert_msg+\"<b><span style=\\\"color:red;\\\">\"+parseFloat(r.message)+\" Dr.</span></b>\";\n                                    } else if (parseFloat(r.message) < 0) {\n                                          alert_msg = alert_msg+\"<b><span style=\\\"color:blue;\\\">\"+parseFloat(r.message)+\" Cr.</span></b>\";\n                                    } else {\n                                          alert_msg = alert_msg+\"<b><span style=\\\"color:black;\\\"> 0.00</span></b>\";\n                                    }\n\t\t\t\t\t  \t\t\t\t\t  show_alert(alert_msg, 8);\n\t\t\t\t} else {\n                                          show_alert(frm.doc.customer+\" Current Balance:<b><span style=\\\"color:black;\\\"> 0.00</span></b>\",8);\n                                    }\n\t\t\t}\n\t\t});          \n            }\n});\ncur_frm.cscript.onload = function() {\n   cur_frm.set_query(\"customer\", function(doc) {\n   \treturn{\n\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_customer_query\"\n\t}\n   });\n   cur_frm.set_query(\"shipping_address_name\", function(doc) {\n   \treturn{\n\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_address_query\",\n                filters: {'customer':doc.customer}\n\t}\n   });\n};\nfrappe.ui.form.on(\"Sales Order\", \"items_on_form_rendered\", function(frm) {\n    // Important Note : Sub Form Fieldname+\"_on_form_rendered\" would trigger and add\n    // The button in child form\n    var grid_row = cur_frm.open_grid_row();\n\n    // Add Button to Child Form ... Wrap it around the \"dialog_result\" field\n    var $btn = $('<button class=\"btn btn-sm btn-default\">' + __(\"Current Stock\") + '</button>')\n        .appendTo($(\"<div>\")\n            .css({\n                \"margin-bottom\": \"10px\",\n                \"margin-top\": \"10px\"\n            })\n            .appendTo(grid_row.grid_form.fields_dict.item_code.$wrapper));\n\n    // Bind a Event to Added Button\n    $btn.on(\"click\", function() {\n\tif (grid_row.grid_form.fields_dict.item_code.value) {\n            frappe.call({\n                method: \"mapl_customization.customizations_for_mapl.utils.get_effective_stock_at_all_warehouse\",\n                args: {\n                    \"item_code\": grid_row.grid_form.fields_dict.item_code.value,\n                    \"date\": cur_frm.doc.transaction_date\n                },\n\n                callback: function(r) {\n                    if (r.message) {\n                        custom.show_stock_dialog(r.message);\n                    }\n                }\n            });\t\n\t}\n    });\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Schemes", 
  "modified": "2016-02-22 13:43:36.921205", 
  "name": "Schemes-Client", 
  "script": "frappe.ui.form.on(\"Schemes\", \"status\", function (frm) {\n         cur_frm.set_df_property(\"closed_on\", \"reqd\", frm.doc.status==\"Settled\");\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Item", 
  "modified": "2016-03-04 17:38:03.957588", 
  "name": "Item-Client", 
  "script": "frappe.ui.form.on(\"Item\",\"onload\", function(frm) {\n             if (frm.doc.__islocal) {\n\t\t\treturn frappe.call({\n\t\t\t\tmethod: \"erpnext.controllers.accounts_controller.get_default_taxes_and_charges\",\n\t\t\t\targs: {\n\t\t\t\t\t\"master_doctype\": \"Item Taxes Template\"\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif(!r.exc) {\n\t\t\t\t\t\tme.frm.set_value(\"taxes\", r.message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n            }\n\t});\nfrappe.ui.form.on(\"Item\",\"taxes_template\", function(frm) {\n\t\tif(frm.doc.taxes_template) {\n\t\t\treturn frappe.call({\n\t\t\t\tmethod: \"erpnext.controllers.accounts_controller.get_taxes_and_charges\",\n\t\t\t\targs: {\n\t\t\t\t\t\"master_doctype\": \"Item Taxes Template\",\n                                        \"master_name\": frm.doc.taxes_template\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif(!r.exc) {\n\t\t\t\t\t\tme.frm.set_value(\"taxes\", r.message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Purchase Invoice", 
  "modified": "2016-09-17 19:50:41.453010", 
  "name": "Purchase Invoice-Client", 
  "script": "cur_frm.add_fetch('item_code', 'is_vehicle', 'is_vehicle');\n/***************************************************************/\n/*              Invoke Dialog On Child Form                    */\n/***************************************************************/\n\nfrappe.ui.form.on(\"Purchase Invoice\", \"items_on_form_rendered\", function(frm) {\n    // Important Note : Sub Form Fieldname+\"_on_form_rendered\" would trigger and add\n    // The button in child form\n    var grid_row = cur_frm.open_grid_row();\n\n    // Add Button to Child Form ... Wrap it around the \"dialog_result\" field\n    var $btn = $('<button class=\"btn btn-sm btn-default\">' + __(\"Add Serial No\") + '</button>')\n        .appendTo($(\"<div>\")\n            .css({\n                \"margin-bottom\": \"10px\",\n                \"margin-top\": \"10px\"\n            })\n            .appendTo(grid_row.grid_form.fields_dict.serial_no.$wrapper));\n\n    // Bind a Event to Added Button\n    $btn.on(\"click\", function() {\n        var fields = [];\n        for (var rows = 1; rows <= grid_row.grid_form.fields_dict.received_qty.get_value() + 1; rows++) {\n            fields.push({\n                label: \"Row No:\".concat(rows),\n                fieldname: \"row_no_\".concat(rows),\n                fieldtype: \"Section Break\"\n            });\n            for (var columns = 1; columns <= 3; columns++) {\n                if (columns == 1) {\n                    fields.push({\n                        label: \"Serial/Chassis No\",\n                        fieldname: \"chassis_no_\".concat(rows),\n                        fieldtype: \"Data\",\n                        reqd: 1\n                    });\n                }\n                if (grid_row.grid_form.fields_dict['is_vehicle'].value == 1) {\n                    if (columns == 2) {\n                        fields.push({\n                            label: \"Engine No\",\n                            fieldname: \"engine_no_\".concat(rows),\n                            fieldtype: \"Data\",\n                            reqd: 1\n                        });\n                    }\n                    if (columns == 3) {\n                        fields.push({\n                            label: \"Key No\",\n                            fieldname: \"key_no_\".concat(rows),\n                            fieldtype: \"Data\",\n                            reqd: 1\n                        });\n                    }\n                    if (columns < 3) {\n                        fields.push({\n                            fieldname: \"column_no_\".concat(columns),\n                            fieldtype: \"Column Break\"\n                        });\n                    }\n                }\n            }\n        }\n        // Add \"Add\" Button to the Dialog\n        fields.push({\n            fieldtype: \"Section Break\"\n        });\n        //fields.push({fieldtype: \"Button\", \"label\": \"Set\", fieldname: \"add\"});\n\n\n        var d = new frappe.ui.Dialog({\n            title: __(\"Add Serial No\"),\n            fields\n        });\n\n        if (grid_row.grid_form.fields_dict.serial_no.get_value() != \"\") {\n            var existing_serial_no = grid_row.grid_form.fields_dict.serial_no.get_value().split(\"\\n\");\n            var existing_engine_no = grid_row.grid_form.fields_dict.serial_no.get_value().split(\"\\n\");\n            var existing_key_no = grid_row.grid_form.fields_dict.serial_no.get_value().split(\"\\n\");\n            for (var row = 1; row <= existing_serial_no.length + 1; row++) {\n                d.set_value(\"chassis_no_\".concat(row), existing_serial_no[row - 1]);\n                d.set_value(\"engine_no_\".concat(row), existing_engine_no[row - 1]);\n                d.set_value(\"key_no_\".concat(row), existing_key_no[row - 1]);\n            }\n        }\n        //Bind Event to Add Button in Dialog\n        d.set_primary_action(__(\"Save\"), function() {\n            /*****************/\n            args = d.get_values();\n            if (!args) return;\n            frappe.call({\n                method: \"mapl_customization.customizations_for_mapl.utils.validate_input_serial\",\n                args: {\n                    \"args\": d.get_values(),\n                    \"rows\": grid_row.grid_form.fields_dict.received_qty.get_value() + 1,\n                    \"is_vehicle\": grid_row.grid_form.fields_dict['is_vehicle'].value\n                },\n\n                callback: function(r) {\n                    if (!r.message) {\n                        //return;\n                    }\n                }\n            });\n\n            /*****************/\n\n            //d.get_input(\"add\").on(\"click\", function() {\n            var result_serial_no = \"\";\n            var result_engine_no = \"\";\n            var result_key_no = \"\";\n            for (var rows = 1; rows <= grid_row.grid_form.fields_dict.received_qty.get_value() + 1; rows++) {\n                result_serial_no = result_serial_no.concat(d.get_value(\"chassis_no_\".concat(rows)), \"\\n\");\n                //Set Resultant Value from Dialog in a Child Form Field - Here dialog_result\n                grid_row.grid_form.fields_dict.serial_no.set_model_value(result_serial_no);\n                result_engine_no = result_engine_no.concat(d.get_value(\"engine_no_\".concat(rows)), \"\\n\");\n                //Set Resultant Value from Dialog in a Child Form Field - Here dialog_result\n                grid_row.grid_form.fields_dict.engine_nos.set_model_value(result_engine_no);\n                result_key_no = result_key_no.concat(d.get_value(\"key_no_\".concat(rows)), \"\\n\");\n                //Set Resultant Value from Dialog in a Child Form Field - Here dialog_result\n                grid_row.grid_form.fields_dict.key_nos.set_model_value(result_key_no);\n            }\n            d.hide();\n            return false;\n        });\n\n        d.show();\n    });\n});\n/***************************************************************/\n/*              End Dialog On Child Form                       */\n/***************************************************************/", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Supplier", 
  "modified": "2016-07-28 20:40:39.882648", 
  "name": "Supplier-Client", 
  "script": "frappe.ui.form.on(\"Supplier\",\"refresh\", function(frm) {\n                   custom._get_party_balance_in_drcr('Supplier', frm.doc.name,\n\t\t\t\t\t\t\tfrappe.defaults.get_user_default(\"company\"), function(result) { \n\t\t\t\t\t\t\t\tfrm.doc.current_balance=result; \nrefresh_field(\"current_balance\");\n                             });\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Payment Entry", 
  "modified": "2017-02-14 14:22:30.031255", 
  "name": "Payment Entry-Client", 
  "script": "frappe.ui.form.on(\"Payment Entry\", \"onload\", function(frm) {\n   frm.set_query(\"party\", function(doc) {\n   \treturn{\n\t\tquery: \"mapl_customization.customizations_for_mapl.queries.select_customer_supplier_query\",\n        filters: {'party_type':doc.party_type }\n\t}\n   });\n   frm.set_query(\"party_address\", function(doc) {\n       if (doc.party_type==\"Customer\") {\n\t   \treturn{\n\t\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_address_query\",\n\t                filters: {'customer':doc.party}\n\t\t\t}\n       } else {\n\t   \treturn{\n\t\t\tquery: \"mapl_customization.customizations_for_mapl.queries.mapl_address_query\",\n\t                filters: {'supplier':doc.party}\n\t\t\t}\n       }\n   });\n\n});\n\nfrappe.ui.form.on(\"Payment Entry\", \"party\", function(frm) {\n\tif(frm.doc.party_type && frm.doc.party) {\n\t\tfrappe.call({\n\t\t\tmethod: \"mapl_customization.customizations_for_mapl.utils.get_party_name\",\n\t\t\targs: {\n\t\t\t\tparty_type: frm.doc.party_type,\n\t\t\t\tparty: frm.doc.party\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tif(!r.exc && r.message) {\n\t\t\t\t\tfrm.set_value(\"party_name\", r.message);\n\t\t\t\t}\n\t\t\t}\n\t\t});  \n\n          frm.call({\n            method: \"mapl_customization.customizations_for_mapl.utils.get_primary_billing_address\",\n            args: {\n\t\t\t\tparty_type: frm.doc.party_type,\n\t\t\t\tparty: frm.doc.party\n            },\n            callback: function(r) {\n                  if(r.message)\n                     frm.set_value(\"party_address\", r.message);\n                  else\n                     frm.set_value(\"party_address\", null);\n                } \n        });\n        custom._get_party_balance_formatted(frm.doc.party_type, frm.doc.party,\n\t\t\t\tfrm.doc.company, function(result) { \n\t\t\t\t\tshow_alert(result,8); \n                });   \t\t\n\t}\n});\n\nfrappe.ui.form.on(\"Payment Entry\", \"party_address\", function(frm) {\n   if (frm.doc.party_address) {\n          frm.call({\n            method: \"mapl_customization.customizations_for_mapl.utils.fetch_address_details_payments_receipts\",\n            args: {\n                party_address: frm.doc.party_address\n            },\n            callback: function(r) {\n                  if(r.message)\n                     frm.set_value(\"address\", r.message);\n                }\n        });   \n   } else\n        frm.set_value(\"address\", null);   \n});\ncur_frm.fields_dict['party_address'].get_query = function(doc, cdt, cdn) {\n      if (doc.party_type==\"Customer\") {\n\treturn{\n    \tfilters:{'customer': doc.party}\n  \t}\n      } else {\n\treturn{\n    \tfilters:{'supplier': doc.party}\n  \t}\n      }\n};", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Stock Taking", 
  "modified": "2017-02-15 12:16:05.225127", 
  "name": "Stock Taking-Client", 
  "script": "frappe.ui.form.on('Stock Taking Details', {\n    items_add: function(frm) {\n\tvar l = frm.doc.items.length;\n\tif (l > 1) {\n\t\tvar last_value = frm.doc.items[l-2].item_code;\n\t\tif (last_value) {\n\t\t\tfrm.doc.items[l-1].item_code = last_value;\n\t\t}\n\t}\n    }\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Tally Stock Items", 
  "modified": "2017-02-27 16:18:35.663547", 
  "name": "Tally Stock Items-Client", 
  "script": "frappe.listview_settings['Tally Stock Items'] = {\n    onload: function(me){\n\t\tme.page.add_menu_item(__(\"Import to Main Database\"), function() {\n\t\t\tfrappe.set_route(\"tally-import\");\n\t\t});\n    }\n}", 
  "script_type": "Client"
 }
]